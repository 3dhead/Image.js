/*! 
 * ImageDrawer.js
 * 
 * @version v1.1.0
 * @link    https://github.com/UstymUkhman/ImageDrawer.js
 * @author  <ustym.ukhman@gmail.com>
 * 
 */"use strict";!function(i){i.fn.extend({drawImage:function(e){var n=0,o=null,a={},r=i(this).find("img"),t=null,s=null,l=null;"function"==typeof e?o=e:"object"==typeof e&&(a=e);var c={duration:a.duration||{borderPencil:6,pencilShades:4,colorShades:5,fullColors:5},callback:o||a.callback,background:a.background||"#FFF",pencil:a.pencil||null},d=i("<div>").css({"background-color":c.background}),u=function(e){var n=!0;return i.each(e,function(i,e){"src"!==i&&"invertAxis"!==i&&"fromBottom"!==i&&"number"!=typeof e&&(console.warn('The value of "'+i+'" in "pencil" has to be a number.'),n=!1)}),n},p=function(i,e){var n=e.pos.fromBottom?e.width:e.pos.marginLeft,o=e.pos.fromBottom?e.height:e.pos.marginTop,a=e.pos.invertAxis?5.925925:177.77777,r=e.pos.invertAxis?100:10,t=e.width/r,s=e.height/a,c=n+t,d=o+s,r=n,a=o;e.pos.fromBottom&&(r=e.pos.marginLeft,a=e.pos.marginTop,t=-t,s=-s);var u=function(){i.css({transform:"translate3d("+n+"px, "+o+"px, 0px)","-webkit-transform":"translate3d("+n+"px, "+o+"px, 0px)"}),(c>=e.width||r>=c)&&(t=-t),n+=t,c=n+t,(d>=e.height||a>d)&&(s=-s),o+=s,d=o+s,l=requestAnimationFrame(u)};l=requestAnimationFrame(u)};if(i.isArray(c.duration)){var m=0;t={borderPencil:c.duration[0]+"s",pencilShades:c.duration[1]+"s",colorShades:c.duration[2]+"s",fullColors:c.duration[3]+"s"};for(var h=0;4>h;h++)m+=c.duration[h]}if("number"==typeof c.duration){var f=c.duration/4,b=c.duration/10;t={borderPencil:6*b+"s",pencilShades:4*b+"s",colorShades:f+"s",fullColors:f+"s"}}else i.isArray(c.duration)||(t={borderPencil:c.duration.borderPencil+"s",pencilShades:c.duration.pencilShades+"s",colorShades:c.duration.colorShades+"s",fullColors:c.duration.fullColors+"s"});return null!==c.pencil&&u(c.pencil)&&(s=i("<img>").attr({src:c.pencil.src}).css({position:"absolute",width:c.pencil.width+"px",height:c.pencil.height+"px","z-index":1500}),i(this).prepend(s),p(s,{height:r.height()+c.pencil.marginTop,width:r.width()+c.pencil.marginLeft,pos:c.pencil})),i(this).prepend(d),d.addClass("imgBackground").css({"animation-duration":t.borderPencil}).css({"-webkit-animation-duration":t.borderPencil}),r.addClass("visibleImage borderPencil").css({"animation-duration":t.borderPencil,"-webkit-animation-duration":t.borderPencil}).on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){var i,e,o;switch(n++){case 0:d.remove(),i="borderPencil",e="pencilShades",o=t.pencilShades;break;case 1:i="pencilShades",e="colorShades",o=t.colorShades;break;case 2:i="colorShades",e="fullColors",o=t.fullColors;break;case 3:return r.css({filter:"brightness(1.05) saturate(1.05)","-webkit-filter":"brightness(1.05) saturate(1.05)"}).removeClass("fullColors").removeClass("visibleImage"),void(null!==l?(cancelAnimationFrame(l),c.pencil.disappear&&s.addClass("pencil").css({top:s.offset().top+"px",left:s.offset().left+"px","animation-duration":c.pencil.disappear+"s","-webkit-animation-duration":c.pencil.disappear+"s"}),setTimeout(function(){s.remove(),null!==c.callback&&c.callback()},1e3*c.pencil.disappear)):null!==c.callback&&c.callback())}r.removeClass(i).addClass(e).css({"animation-duration":o,"-webkit-animation-duration":o})}),this}})}(jQuery);