/*! 
 * ImageDrawer.js
 * 
 * @version v1.0.0
 * @link    https://github.com/UstymUkhman/ImageDrawer.js
 * @author  <ustym.ukhman@gmail.com>
 * 
 */"use strict";!function(e){e.fn.extend({drawImage:function(n){var i=0,a=null,o={},r=e(this).find("img"),l=null,t=null,s=null;"function"==typeof n?a=n:"object"==typeof n&&(o=n);var c={duration:o.duration||{borderPencil:6,pencilShades:4,colorShades:5,fullColors:5},callback:a||o.callback,background:o.background||"#FFF",pencil:o.pencil||null},d=e("<div>").css({"background-color":c.background}),u=function(n){var i=!0;return e.each(n,function(e,n){"number"!=typeof n&&"src"!==e&&(console.warn('The value of "'+e+'" in "pencil" has to be a number.'),i=!1)}),i},p=function(e,n){var i=n.x,a=n.y,o=n.width/10,r=n.height/177.77777,l=i+o,t=a+r,c=function(){e.css({transform:"translate3d("+i+"px, "+a+"px, 0px)","-webkit-transform":"translate3d("+i+"px, "+a+"px, 0px)"}),(l>=n.width||l<=n.x)&&(o=-o),i+=o,l=i+o,(t>=n.height||t<n.y)&&(r=-r),a+=r,t=a+r,s=requestAnimationFrame(c)};s=requestAnimationFrame(c)};if("number"==typeof c.duration){var h=duration/4,b=duration/10;l={borderPencil:6*b+"s",pencilShades:4*b+"s",colorShades:h+"s",fullColors:h+"s"}}if(e.isArray(c.duration)){var m=0;l={borderPencil:c.duration[0]+"s",pencilShades:c.duration[1]+"s",colorShades:c.duration[2]+"s",fullColors:c.duration[3]+"s"};for(var f=0;4>f;f++)m+=c.duration[f];c.duration=m}else l={borderPencil:c.duration.borderPencil+"s",pencilShades:c.duration.pencilShades+"s",colorShades:c.duration.colorShades+"s",fullColors:c.duration.fullColors+"s"},c.duration=20;return null!==c.pencil&&u(c.pencil)&&(t=e("<img>").attr({src:c.pencil.src}).css({position:"absolute",width:c.pencil.width+"px",height:c.pencil.height+"px","z-index":1500}),e(this).prepend(t),p(t,{x:c.pencil.marginLeft,y:c.pencil.marginTop,height:r.height(),width:r.width()})),e(this).prepend(d),d.addClass("imgBackground").css({"animation-duration":l.borderPencil}).css({"-webkit-animation-duration":l.borderPencil}),r.addClass("visibleImage borderPencil").css({"animation-duration":l.borderPencil,"-webkit-animation-duration":l.borderPencil}).on("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){var e,n,a;switch(i++){case 0:d.remove(),e="borderPencil",n="pencilShades",a=l.pencilShades;break;case 1:e="pencilShades",n="colorShades",a=l.colorShades;break;case 2:e="colorShades",n="fullColors",a=l.fullColors;break;case 3:return r.css({filter:"brightness(1.05) saturate(1.05)","-webkit-filter":"brightness(1.05) saturate(1.05)"}).removeClass("fullColors").removeClass("visibleImage"),void(null!==s?(cancelAnimationFrame(s),c.pencil.disappear&&t.addClass("pencil").css({top:t.offset().top+"px",left:t.offset().left+"px","animation-duration":c.pencil.disappear+"s","-webkit-animation-duration":c.pencil.disappear+"s"}),setTimeout(function(){t.remove(),null!==c.callback&&c.callback()},1e3*c.pencil.disappear)):null!==c.callback&&c.callback())}r.removeClass(e).addClass(n).css({"animation-duration":a,"-webkit-animation-duration":a})}),this}})}(jQuery);